---
import { getImage } from "astro:assets";
interface Props {
    image?: string;
    title?: string;
}

const { image="/src/media/sco-heim.jpg", title="SCO-OGV Oberf√ºllbach 1963 e.V." } = Astro.props;
const images = import.meta.glob<{ default: ImageMetadata }>('/src/media/**/*.{jpeg,jpg,png,gif}');
const finalImageUrl = image;
if (!images[finalImageUrl]) throw new Error(`"${finalImageUrl}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`);
const optimizedBackgroundXs = await getImage({src: images[finalImageUrl](), format: 'webp', width:'500', height:'264'});
const optimizedBackgroundSm = await getImage({src: images[finalImageUrl](), format: 'webp', width:'1000', height:'528'});
const optimizedBackgroundMd = await getImage({src: images[finalImageUrl](), format: 'webp', width:'1500', height:'792'});
const optimizedBackgroundLg = await getImage({src: images[finalImageUrl](), format: 'webp', width:'2000', height:'1056'});
const optimizedBackgroundXsSrc = `url('${ optimizedBackgroundXs.src}')`;
const optimizedBackgroundSmSrc = `url('${ optimizedBackgroundSm.src}')`;
const optimizedBackgroundMdSrc = `url('${ optimizedBackgroundMd.src}')`;
const optimizedBackgroundLgSrc = `url('${ optimizedBackgroundLg.src}')`;
---
<div class="stage-wrapper">
    <div class="stage">
        <div class="content">
            <h1 class="headline font-bold py-4 md:py-8">{title}</h1>
        </div>
    </div>
</div>

<style define:vars={{ optimizedBackgroundXsSrc, optimizedBackgroundSmSrc, optimizedBackgroundMdSrc, optimizedBackgroundLgSrc}}>
    .stage-wrapper {
        background-repeat: no-repeat;
        background-size: cover;
        background-position: 50% 50%;
        background-image: var(--optimizedBackgroundSmSrc);
        @media (max-width:425px) {
            background-image: var(--optimizedBackgroundXsSrc);
        }
        @media (min-width:1024px) {
            background-image: var(--optimizedBackgroundMdSrc);
        }
        @media (min-width:1440px) {
            background-image: var(--optimizedBackgroundLgSrc);
        }
    }
    .stage {
        min-height: min(40vw, 50vh);
        display:flex;
        align-items: flex-end;
        position: relative;
    }
    .stage::after {
        content:"";
        display:block;
        z-index:1;
        bottom:0;
        left:0;
        right:0;
        height:50%;
        position: absolute;
        background-image: linear-gradient(180deg,rgba(35,32,39,0) 0,rgba(35,32,39,.011) 8.1%,rgba(35,32,39,.042) 15.5%,rgba(35,32,39,.09) 22.5%,rgba(35,32,39,.153) 29%,rgba(35,32,39,.226) 35.3%,rgba(35,32,39,.306) 41.2%,rgba(35,32,39,.392) 47.1%,rgba(35,32,39,.478) 52.9%,rgba(35,32,39,.564) 58.8%,rgba(35,32,39,.644) 64.7%,rgba(35,32,39,.717) 71%,rgba(35,32,39,.78) 77.5%,rgba(35,32,39,.828) 84.5%,rgba(35,32,39,.859) 91.9%,rgba(35,32,39,.87));
    }


    .content {
       @apply mx-auto container text-neutral-200 px-4;
    }
    .content > * {
        position: relative;
        z-index:10;
    }

    .headline {
        font-size: clamp(1.3em, 4vw, 3em);
    }
</style>