---
import { getCollection } from "astro:content";
import FormattedDate from "../../components/FormattedDate.astro";
import App from "../../layouts/App.astro";
import { Picture } from "astro-imagetools/components";
import BadgeMini from "../../components/BadgeMini.astro";
import HpCard from "../../components/HpCard.astro";

const events = (await getCollection("veranstaltungen"))
  .sort((a, b) => a.data.eventDate.valueOf() - b.data.eventDate.valueOf())
  .reverse();
  
const title = "Veranstaltungen - SCO-OGV Oberfüllbach";
const description = "Überblick über alle Veranstaltungen des SCO-OGV Oberfüllbach";
---
<App title={title} description={description}>
  <div class="main container grid gap-4 mx-auto p-4 overflow-hidden">
    <aside class="news">
      <HpCard>
        <div class="flex gap-2 justify-between items-center" slot="title">
          <h2 class="font-bold">Regeltermine (position:sticky machen)</h2>
        </div>
          <ul class="whitespace-nowrap">
            <li class="">
              <div class="inline-flex flex-row gap-2 overflow-hidden max-w-full block py-2">
                <BadgeMini>
                  <span class="font-semibold">Mi, So: ab 17:00 Uhr</span>
                </BadgeMini>
                <span class="overflow-hidden text-ellipsis">Steeldarts</span>
              </div>
            </li>
          </ul>
      </HpCard>
    </aside>
    <main class="content">
      <section>
        <ul class="grid grid-cols-1 gap-4">
          {
            events.map((event) => (
              <li>
                <a
                  class="flex gap-4 w-full bg-white rounded-lg p-4 border border-slate-200 hover:shadow"
                  href={`/veranstaltungen/${event.slug}/`}
                  title={event.data.title}
                >
                  {event.data.heroImage && (
                    <div class="rounded overflow-hidden">
                      <Picture
                        fit="cover"
                        width="250"
                        height="250"
                        alt={event.data.title}
                        src={event.data.heroImage}
                      />
                    </div>
                  )}
                  <div class="flex flex-col justify-between gap-2 w-full">
                    <div class="flex flex-col gap-2">
                      <h2 class="text-xl font-bold">{event.data.title}</h2>
                      <div class="flex flex-wrap gap-4 gap-y-2">
                        <BadgeMini>
                          <b>Am:</b>
                          {event.data.eventDate.toLocaleDateString("de-DE", {
                            weekday: "short",
                          })}
                          ,
                          <FormattedDate
                            date={event.data.eventDate}
                            time={true}
                          />
                        </BadgeMini>
                        {event.data.location && (
                          <BadgeMini>
                            <strong>Ort:</strong> {event.data.location}
                          </BadgeMini>
                        )}
                      </div>
                    </div>
                    <span class="self-end text-xs text-center font-semibold inline-flex gap-2 items-center py-2 px-4 justify-center rounded-full bg-slate-100 hover:bg-slate-200">
                      Mehr erfahren
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        viewBox="0 0 256 256"
                      >
                        <path
                          fill="currentColor"
                          d="m224.49 136.49l-72 72a12 12 0 0 1-17-17L187 140H40a12 12 0 0 1 0-24h147l-51.49-51.52a12 12 0 0 1 17-17l72 72a12 12 0 0 1-.02 17.01Z"
                        />
                      </svg>{" "}
                    </span>
                  </div>
                </a>
              </li>
            ))
          }
        </ul>
      </section>
    </main>
  </div>
</App>
<style>	.day {
  display: inline-block;
  width: 3ch;
}
  ul {
    list-style-type: none;
    padding: unset;
  }
  ul li {
    display: flex;
  }
  section {
    @apply container mx-auto;
  }

  .main {
    grid-area: main;
  }
  @media (max-width: 767px) {
    .main {
      grid-template-areas:
        "news"
        "content"
        "sidebar";
      grid-template-columns: 1fr;
      grid-template-rows: 2fr;
    }
    .content {
      grid-area: content;
    }
    aside {
      grid-area: sidebar;
    }
    aside.news {
      grid-area: news;
    }
  }
  @media (min-width: 768px) {
    .main {
      grid-template-areas: "content content sidebar";
      grid-template-columns: 2fr 2fr 3fr;
      grid-template-rows: 1fr;
    }
    .content {
      grid-area: content;
    }
    aside {
      grid-area: sidebar;
    }
  }
  @media (min-width: 1280px) {
    .main {
      grid-template-columns: 1fr 1fr 1fr;
    }
  }
</style>
